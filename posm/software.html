

<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Software · The Outpost</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.0.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../leaflet/" />
    
    
    <link rel="prev" href="hardware.html" />
    

        <link rel="shortcut icon" href="/images/favicon.png" type="image/png">
    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            <div class="site-heading">
                <div class="site-name">The Outpost</div>
                
                <div id="book-search-input" role="search">
                    <form id="search-form">
                        <input type="text" placeholder="Search The Outpost" />
                    </form>
                </div>
                
            </div>
            
                <nav role="navigation">
                


<ul class="summary">
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Welcome
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../openmapkit/">
            
                <a href="../openmapkit/">
            
                    
                    OpenMapKit
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../openmapkit/android.html">
            
                <a href="../openmapkit/android.html">
            
                    
                    OpenMapKit Android
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../openmapkit/server.html">
            
                <a href="../openmapkit/server.html">
            
                    
                    OpenMapKit Server
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="./">
            
                <a href="./">
            
                    
                    POSM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="story.html">
            
                <a href="story.html">
            
                    
                    The Story
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="hardware.html">
            
                <a href="hardware.html">
            
                    
                    Hardware
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.1.3" data-path="software.html">
            
                <a href="software.html">
            
                    
                    Software
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../leaflet/">
            
                <a href="../leaflet/">
            
                    
                    Leaflet Plugins
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../resume/">
            
                <a href="../resume/">
            
                    
                    Résumé
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../wiki/">
            
                <a href="../wiki/">
            
                    
                    Wiki
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Software</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                            <div id="book-search-results">
                                <div class="search-noresults">
                                    <section class="normal markdown-section">
                                    
                                    <h1 id="posm-software-github">POSM Software <a class="github-button" href="https://github.com/AmericanRedCross/posm" data-style="mega" aria-label="Star AmericanRedCross/posm on GitHub" _target="blank">Github</a></h1>
<p>POSM is a suite of many different open source software components. This guide is intended to help familiarize you with each major component.</p>
<h1 id="posm-build-github">POSM Build <a class="github-button" href="https://github.com/AmericanRedCross/posm-build" data-style="mega" aria-label="Star AmericanRedCross/posm-build on GitHub" _target="blank">Github</a></h1>
<p>POSM Build is a collection of <code>bash</code> scripts and configuration files that install all of the software found on the POSM. There are quite a few components to install, and the configuration is complex enough that we built a tool that does all of this work work for us in an automated way.</p>
<p>POSM Build can be run manually, but it also can be setup to run as a debian preseed on a USB installer. Manual installs are great for development and installing in the non-standard hardware (like AWS). The automated debian preseed allows you to boot to a USB installer and let the install roll without user input.</p>
<p>Further details that explain why we choose custom shell scripts over custom debian packages and other provisioning tools are availible in the <a href="https://github.com/AmericanRedCross/posm/blob/master/docs.md#ubuntu-1404" _target="blank">POSM Docs</a>.</p>
<p>Check out the POSM Build repo for <a href="https://github.com/AmericanRedCross/posm-build#posm-build" _target="blank">step-by-step instructions</a> for both the manual and automated POSM builds.</p>
<h1 id="posm-admin-github">POSM Admin <a class="github-button" href="https://github.com/AmericanRedCross/posm-admin" data-style="mega" aria-label="Star AmericanRedCross/posm-admin on GitHub" _target="blank">Github</a></h1>
<p>POSM Admin is the administrator&apos;s console to the POSM. It is a NodeJS project that wraps and automates a <a href="https://github.com/AmericanRedCross/posm-admin/blob/master/docs/scripts.md" _target="blank">collection of shell and NodeJS scripts</a> that do the heavy lifting for provisining OpenStreetMap data to your POSM and OpenMapKit.</p>
<p><img src="../images/posm/posm-admin-screenshot.png" alt="POSM Admin Screenshot"></p>
<p>It allows you to do three things:</p>
<ol>
<li>Provision OSM data and MBTiles to the POSM for your Area of Interest.</li>
<li>Depoly OSM XML and MBTiles to OpenMapKit for the area of a Field Papers atlas.</li>
<li>Update the Render DB with the latest data in the API DB.</li>
</ol>
<p>We have a customized HOT Export tool at <a href="http://export.posm.io" _target="blank">http://export.posm.io</a> that we use to package MBTiles basemaps and OpenStreetMap data for the POSM Admin tool.</p>
<p>For instructions on using POSM Admin, take a look at the <a href="https://github.com/AmericanRedCross/posm-admin/blob/master/docs/deployment-walkthrough.md" _target="blank">Complete Deployment Walkthrough</a>.</p>
<h1 id="openstreetmap">OpenStreetMap</h1>
<p>The OpenStreetMap website and API is the heart of the POSM project. We are using the same software stack as <a href="http://openstreetmap.org" _target="blank">openstreetmap.org</a>, except for a few small changes. We refer to the PostgreSQL database used by the Rails API and CGImap as the <em>API DB</em>, and this database adheres to the <a href="https://github.com/AmericanRedCross/openstreetmap-website/blob/posm/db/structure.sql" _target="blank">schema</a> of the OSM website.</p>
<h2 id="openstreetmap-website-github">OpenStreetMap Website <a class="github-button" href="https://github.com/AmericanRedCross/openstreetmap-website" data-style="mega" aria-label="Star AmericanRedCross/openstreetmap-website on GitHub" _target="blank">Github</a></h2>
<p>The OpenStreetMap Website is the website you interact with when you go to <a href="http://openstreetmap.org" _target="blank">openstreetmap.org</a>. It is a Ruby on Rails application, and in addition to generating the front-end web site, it also provides the majority of the <a href="http://wiki.openstreetmap.org/wiki/API_v0.6" _target="blank">OSM Editing API v0.6</a>.</p>
<p>POSM has made a few small changes:</p>
<ul>
<li>Turned off authentication, create a single user called POSM.</li>
<li>Make the POSM basemap the default.</li>
<li>Automated setup of default home position.</li>
</ul>
<h2 id="cgimap-github">CGImap <a class="github-button" href="https://github.com/AmericanRedCross/openstreetmap-cgimap" data-style="mega" aria-label="Star AmericanRedCross/openstreetmap-cgimap on GitHub" _target="blank">Github</a></h2>
<p>CGImap replaces a portion of the Ruby On Rails API. CGImap is a high performance FCGI API written in C++. We <a href="https://github.com/AmericanRedCross/posm-build/blob/master/kickstart/etc/nginx-osm.conf" _target="blank">integrate it&apos;s endpoints</a> via <code>fastcgi_pass</code> directives in NGINX. The Rails app has some memory leak problems, and is not performant enough for the endpoints that are hit hard in a production environment. In particular, it serves the GET requests for the following endpoints:</p>
<ul>
<li><code>/map</code><ul>
<li>OSM XML for a bounding box</li>
</ul>
</li>
<li>nodes, ways, relations<ul>
<li>XML for specific OSM elements, including a comma delineated list of element IDs.</li>
</ul>
</li>
</ul>
<h2 id="tessera-github">Tessera <a class="github-button" href="https://github.com/mojodna/tessera" data-style="mega" aria-label="Star mojodna/tessera on GitHub" _target="blank">Github</a></h2>
<p>Tessera is a NodeJS tile server created by <a href="http://stamen.com/about/who/seth-fitzsimmons/" _target="blank">Seth Fitzsimmons</a>. Tessera is easy to use, robust, and a commonly used tool at Stamen. We chose this tool instead of the traditional OpenStreetMap <a href="https://github.com/openstreetmap/mod_tile" _target="blank">mod_tile</a>. Tessera uses <a href="https://github.com/mapbox/tilelive-mapnik" _target="blank">tilelive-mapnik</a> to drive Mapnik and output the requested <code>.png</code> raster tiles.</p>
<p>Tessera uses a second PostGIS database that is populated by <a href="https://github.com/AmericanRedCross/posm-build/blob/843b560735e305503cca1c8caa24cec5c3043df4/kickstart/scripts/osm-deploy.sh#L143" _target="blank"><code>osm2pgsql</code></a>. We refer to this database as the <em>Render DB</em>. This database is optimized for the Mapnik renderer, and it is periodically updated from the <em>API DB</em>.</p>
<h2 id="posm-carto-github">POSM Carto <a class="github-button" href="https://github.com/AmericanRedCross/posm-carto" data-style="mega" aria-label="Star AmericanRedCross/posm-carto on GitHub" _target="blank">Github</a></h2>
<p>POSM Carto is the repo that tracks the Carto CSS style used to render the POSM basemap. It includes a <code>Makefile</code> and <code>project.json</code> that makes it easy to generate the Mapnik XML style needed to render the tiles. This cartography was designed by the <a href="https://americanredcross.github.io/" _target="blank">American Red Cross GIS team</a> and <a href="http://stamen.com/about/who/alan-mcconchie/" _target="blank">Alan McConchie</a> at Stamen Design.</p>
<h1 id="field-papers-github">Field Papers <a class="github-button" href="https://github.com/fieldpapers/fieldpapers" data-style="mega" aria-label="Star fieldpapers/fieldpapers on GitHub" _target="blank">Github</a></h1>
<p>Field Papers is a web application that lets you print sections of an OpenStreetMap basemap on a piece of paper and then hand draw notes and features. When finished, you then take a photo of your notes and upload them to Field Papers. With some clever usage of computer vision (<a href="http://opencv.org/" _target="blank">OpenCV</a>), your photo is ortho-rectified as an overlay in JOSM or the iD Editor. This workflow enables you to then trace over your notes in an OSM editor.</p>
<p>The Field Papers on POSM is the same that you will find on <a href="http://fieldpapers.org" _target="blank">fieldpapers.org</a>, except that it is set up to use the POSM basemap as the default and be centered to the area of interest. Field Papers is a Ruby on Rails app with some Python and C++ components. It runs fully offline on the POSM.</p>
<p>The <a href="https://github.com/fieldpapers/fieldpapers/blob/master/README.md" _target="blank">README</a> on the Field Papers main repo gives more technical details about the underlying architecture of the project.</p>
<p>If you are unfamiliar with Field Papers, give it a try at:</p>
<p><a href="http://fieldpapers.org" _target="blank">http://fieldpapers.org</a></p>
<p>Field Papers is maintained primarly by <a href="http://stamen.com" _target="blank">Stamen</a>, with contributions from <a href="http://cadasta.org/" _target="blank">Cadasta</a>.</p>
<script async defer src="https://buttons.github.io/buttons.js"></script>

                                    
                                    </section>
                                </div>
                                <div class="search-results">
                                    <div class="has-results">
                                        
                                        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
                                        <ul class="search-results-list"></ul>
                                        
                                    </div>
                                    <div class="no-results">
                                        
                                        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
                                        
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="hardware.html" class="navigation navigation-prev " aria-label="Previous page: Hardware">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../leaflet/" class="navigation navigation-next " aria-label="Next page: Leaflet Plugins">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        // fix for detecting taps on book body for mobile and narrow screen
        function mobileSidebarCloseFix() {
            function checkToToggle(e) {
                if ($(window).width() <= 600 
                        && e.target.tagName !== 'I'
                        && e.target.tagName !== 'A'
                        && gitbook.sidebar.isOpen()) {
                    gitbook.sidebar.toggle();
                }
            }
            $bookbody = $('.book-body');
            $bookbody.click(function(e) {
                checkToToggle(e);
            });
            $bookbody.on('touchend', function(e) {
                checkToToggle(e);
            });
        }

        // make keyboard disappear when pressing go or enter when typing
        // in search input. fix for mobile behavior.
        function searchInputMobileFix() {
            $('#search-form').submit(function(e) {
                e.preventDefault();
                if(document.activeElement) {
                    document.activeElement.blur();
                    if ($(window).width() <= 600 && gitbook.sidebar.isOpen()) {
                        gitbook.sidebar.toggle();
                    }
                }
            });
        }

        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Software","level":"3.1.3","depth":2,"next":{"title":"Leaflet Plugins","level":"4.1","depth":1,"path":"leaflet/index.md","ref":"leaflet/index.md","articles":[]},"previous":{"title":"Hardware","level":"3.1.2","depth":2,"path":"posm/hardware.md","ref":"posm/hardware.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["expandable-chapters","anchorjs"],"pluginsConfig":{"fontsettings":{"theme":"white","family":"serif","size":2},"expandable-chapters":{},"anchorjs":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"posm/software.md","mtime":"2016-07-22T14:38:37.000Z","type":"markdown"},"gitbook":{"version":"3.0.3","time":"2016-07-22T14:42:29.645Z"},"basePath":"..","book":{"language":""}});
            mobileSidebarCloseFix();
            searchInputMobileFix();
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/buttons.js"></script>
        
    

    </body>
</html>
